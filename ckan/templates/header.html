{% set dataset_type = h.default_package_type() %}

{% block header_wrapper %}
{% block header_account %}
{# Clean account masthead - removed #}
{% endblock %}

<header class="datagovsg-header">
  <div class="header-fullwidth">
    <div class="header-content">

      {# Logo Section #}
      <div class="header-logo">
        <a href="{{ h.url_for('home.index') }}" class="logo-link">
          <svg class="logo-svg" width="32" height="32" viewBox="0 0 32 32" fill="none">
            <rect width="32" height="32" rx="8" fill="url(#logoGradient)"/>
            <path d="M16 8L24 12V20L16 24L8 20V12L16 8Z" fill="white" opacity="0.9"/>
            <defs>
              <linearGradient id="logoGradient" x1="0" y1="0" x2="32" y2="32">
                <stop offset="0%" stop-color="#6253e8"/>
                <stop offset="100%" stop-color="#8b5cf6"/>
              </linearGradient>
            </defs>
          </svg>
          <span class="logo-text">Open Data Platform</span>
        </a>
      </div>

      {# Main Navigation #}
      <nav class="header-nav">
        {% set org_type = h.default_group_type('organization') %}
        {% set group_type = h.default_group_type('group') %}

        <a href="{{ h.url_for(dataset_type ~ '.search') }}" class="nav-link {% if request.path.startswith('/dataset') %}active{% endif %}">
          <span>{{ _('Datasets') }}</span>
        </a>
        <a href="{{ h.url_for(org_type ~ '.index') }}" class="nav-link {% if request.path.startswith('/organization') %}active{% endif %}">
          <span>{{ _('Agencies') }}</span>
        </a>
        <a href="{{ h.url_for('home.about') }}" class="nav-link {% if request.path.startswith('/about') %}active{% endif %}">
          <span>{{ _('Help') }}</span>
        </a>
      </nav>

      {# User Section #}
      <div class="header-user">
        {% if c.userobj %}
          <div class="user-profile">
            <a href="{{ h.url_for('user.read', id=c.userobj.name) }}" class="user-link">
              <div class="user-avatar">{{ c.userobj.display_name[0]|upper }}</div>
              <span class="user-name">{{ c.userobj.display_name }}</span>
            </a>
          </div>
          {% if c.userobj.sysadmin %}
          <a href="{{ h.url_for('admin.index') }}" class="btn-admin" title="{{ _('Admin') }}">
            <i class="fa fa-cog"></i>
          </a>
          {% endif %}
          <form action="{{ h.url_for('user.logout') }}" method="post" style="display: inline;">
            {{ h.csrf_input() }}
            <button type="submit" class="btn-logout">{{ _('Logout') }}</button>
          </form>
        {% else %}
          <a href="{{ h.url_for('user.login') }}" class="btn-login">{{ _('Login') }}</a>
          {% if h.check_access('user_create') %}
          <a href="{{ h.url_for('user.register') }}" class="btn-register">{{ _('Register') }}</a>
          {% endif %}
        {% endif %}
      </div>

      {# Mobile Toggle #}
      <button class="mobile-toggle" type="button" data-bs-toggle="collapse" data-bs-target="#mobileNav">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </button>

    </div>

    {# Mobile Navigation #}
    <div id="mobileNav" class="mobile-nav collapse">
      <div class="mobile-nav-inner">
        <a href="{{ h.url_for(dataset_type ~ '.search') }}" class="mobile-link">{{ _('Datasets') }}</a>
        <a href="{{ h.url_for(org_type ~ '.index') }}" class="mobile-link">{{ _('Agencies') }}</a>
        <a href="{{ h.url_for('home.about') }}" class="mobile-link">{{ _('Help') }}</a>
        <div class="mobile-divider"></div>
        {% if c.userobj %}
          <a href="{{ h.url_for('user.read', id=c.userobj.name) }}" class="mobile-link">{{ c.userobj.display_name }}</a>
          {% if c.userobj.sysadmin %}
          <a href="{{ h.url_for('admin.index') }}" class="mobile-link">{{ _('Admin') }}</a>
          {% endif %}
          <form action="{{ h.url_for('user.logout') }}" method="post">
            {{ h.csrf_input() }}
            <button type="submit" class="mobile-link mobile-link-btn">{{ _('Logout') }}</button>
          </form>
        {% else %}
          <a href="{{ h.url_for('user.login') }}" class="mobile-link mobile-link-primary">{{ _('Login') }}</a>
          {% if h.check_access('user_create') %}
          <a href="{{ h.url_for('user.register') }}" class="mobile-link">{{ _('Register') }}</a>
          {% endif %}
        {% endif %}
      </div>
    </div>

  </div>
</header>
{% endblock %}
